import brotli

decompressor = brotli.Decompressor()

# arrives immediately
chunk1 = bytes.fromhex(
    "85 54 00 00 C0 FF E5 D8 EE 32 3E 1C BF A0 81 43 B7 84 45 44 A1 20 18 34 FC FF 39 0E B3 3C BA AE B0 A2 41 2C 8D EC 8A 6B D6 DC 30 2E C7 26 56 D9 69 7D EB 76 D9 F3 5C 96 5D D3 6E EF 20 66 F4 A3 0F D7 69 88 20 58 DB 56 87 BD B5 9B 59 F0 77 FE 2B 30 82 57 14 90 E0 33 B8 A9 1F 05 46 F0 F6 0F 27 58 40 8C D2 79 51 42 5A 17 20 66 25 46 5A AF 40 F1 17 82 AA AA 26"
)
chunk2 = bytes.fromhex(
    "98 4B 00 00 6E 2A FB DF 5D A6 70 C8 9F 72 5A DB DA AF 01 D9 1F C8 5F 1C A5 C3 35 B9 B6 F9 A6 49 48 52 7D 22 5E 3B 3D 10 8A BC FF 82 40 BB 40 C2 34 AB 2B EA BC 6B 22 03 1E D8 60 93 AC E1 04 C6 BB DB DD 66 F3 99 4F E7 16 0D CE 06 70 CE 31 B0 51 A3 7E 3E 60 0D 28 68 8F A7 33 48 D0 F3 EA 1F 19 D4 1D CE CD 41 E5 42 C5 EA BD A3 DF 9E 62 DC 47 9A 18 BB 6E EC AA BF F5 D1 34 BA 39 0F DD 69 F7 3F 43 2F C1 D3 C2 A0 E0 46 65 CF 1F 1F D7 02 12 28 BF BD 06 35 92 CB FC DD B4 0A B6 B7 C4 A4 CB 2E AF 39 B2 CF 0C 9B 83 BA DF 61 0B 12 32 EB 62 83 27 E9 CA 0F 68 47 39 FF 43 9E 1E 1D FF 8A D1 F1 2F EA E0 C8 A2 92 1C 40 6F AF 4D B2 FC 76 6B 40 C2 B6 45 6E A5 A4 E7 4B B4 0F FA F3 22 5B 2E C1 83 FC C0 48 CE 0D A4 1F A0 E2 AB AB 83 DA 37 4F C9 1A 91 17 35 25 6B 50 07 97 B1 16 8B 31 D1 8D 70 93 DD 8A 89 22 B6 8E 2F A4 88 9D 88 6F 6C 45 1C F0 58 8B E8 48 33 DA C2 4B C6 5C 12 17 3D 77 53 37 F6 49 A7 71 08 C9 70 12 29 AC DE B0 C1 C5 88 61 C2 29 D1 1B BB AA 12 11 60 7B B4 AE 2A 31 06 5F D0 87 B4 90 13 11 6B 21 22 10 F5 4A 39 20 47 1A C2 78 4E 18 BC 7B CB BF 0A AE 81 8C F5 93 88 E1 C1 4B F0 BB DD 0E 4E 50 2B 8C CC C2 89 22 D6 62 98 30 3B 2A 8C 6D 55 89 19 DB FE 2E 28 C8 DB 85 0A 63 5C 5D 66 D8 53 66 BC D7 55 15 7F 7B F1 C2 71 75 0E 3C C5 8B CE 35 AF BF 7F 3A C3 20 CB FE DB FF 75 B5 BD 1E 9D AC 8E EE 37 B5 DA 6F 2C 5C 08 24 54 20 3F A0 67 4A 37 2E A0 60 2D 23 9E 08 BA C5 16 C7 20 E1 10 29 90 61 6F 39 64 FD 24 C6 90 44 B4 0F CA 43 70 52 E3 9A D3 E1 69 F9 15 43 2A 20 41 07 5F D8 17 50 F0 B2 A6 CC 17 C3 4F AB 19 0D 33 A5 B0 DE 16 4B 0E B3 26 C7 97 03 7C FB 7E"
)

# arrives after 2 seconds
chunk3 = bytes.fromhex(
    "03 04 1A 00 60 9D A2 FF 9E 2B E2 2E 4D 48 43 DA E4 9B B4 A7 CF D4 E3 D9 E1 12 1A 58 09 46 C6 59 B7 49 D6 6C 32 21 C4 BD 44 BA 3F F6 6A 21 9E 60 48 C0 E8 5B 06 09 09 15 08 84 45 E0 08 08 8D 43 58 82 C0 6A 94 5F 98 EB B9 4D 22 27 5F 4E 08 09 FC FF C6 DE 23 14 FB 5A C0 C2 B5 AE 79 7D 06 E3 62 07 1D D7 A4 A8 0E AA B7 F5 A2 07 1A B0 A8 43 8A 73 D7 44 FF 6C DB EA 1F 7D EF 95 E3 E3 4F 3B 9F D9 53 A3 56 37 D4 EF 75 87 9B 67 FA C5 8B EA FA D1 CC 8D 33 F6 2D 05 75 1F 37 55 26 CC 6B 91 45 6F A5 BD 6A E1 83 B8 DD 63 73 B8 AF E6 BE EB 0E 2A F8 B8 06 DE F0 54 25 A7 66 15 98 4B 9D DB 96 E0 75 5C 23 87 FD BE 57 4F 4D EB 95 A3 C3 AD BD E1 D3 BF DF AE 6D 2D 14 D9 D7 76 83 CA 9E F2 B4 C3 78 53 8B 1C 3C B5 F8 78 44 17 21 69 20 7E 21 3D DB DE 1E 4B 5E D5 41 41 62 35 5F 1D 9C BB B0 AB 43 B5 56 5C 5F 7C 5A 57 9F 1E 95 FB 09 17 C2 A2 6B 80 05 5F 7A 5B 1A F2 09 38 FE F8 E6 5F 9B 2E A5 51 E7 EC B4 4F D8 FC 9C C4 96 D2 93 A4 AF C4 16 9F EB A6 EB 2E DD 23 D6 E1 77 5A E3 11 D6 AE 7F 46 9A D0 3D 75 65 20 13 58 D9 98 D8 C1 F3 06 5E 06 D9 CC EF 3E 8D 87 1C E4 AC A0 92 31 B1 81 E7 7B 78 F5 C8 FD 2F 55 B0 04 84 A4 1A 13 33 78 FE 04 AF 13 01 A7 BE 14 16 1F 1C 1B 16 0B 78 7E 80 D7 80 3C 0C A5 14 EF 34 1C 52 C9 98 D8 C0 F3 16 5E 16 D9 8E 49 0E 6B 49 F0 77 2B 44 43 92 3D 3F 45 03 5E 13 01 D3 5F 12 52 5C 63 86 A4 1D 94 A0 50 55 8E 89 29 3C 6F E1 65 D9 20 36 64 54 40 9F F3 62 64 63 B2 78 7E 84 D7 88 3C 8E 4F 35 E6 8C 41 CF 56 37 26 2F CF 9F E1 75 46 3E 67 D4 9E F1 07 26 23 1B 93 A7 E7 2F F0 BA 20 5F 32 EA 09 09 2B 26 61 92 3C 3F C1 6B 42 9E 32 0A 12 26 C0 24 44 22 43 8F 37 03 9D 65 06 26 30 C3 18 55 80 38 7B 32 44 45 38 24 D9 F3 16 5E 96 00 BB AA 0C D4 13 DB 33 DC 56 62 43 59 45 43 62 85 1E 3F 76 74 D6 D8 01 8C FF 41 CD A8 17 52 5A E2 82 91 0D C9 BB CD 5F 2F F0 32 84 98 81 B4 6E F0 EB 84 A8 78 26 C3 A2 E5 97 7C BD"
)
chunk4 = bytes.fromhex("0D")

chunks = [chunk1, chunk2, chunk3, chunk4]
decompressed_data = b""

# Let's try to decompress subsets of the data.
for i in range(0, len(chunks)):
    try:
        # Get the subset of the data.
        chunk = chunks[i]

        # Try to decompress the subset.
        decompressed_data = decompressor.process(chunk)

        # If we reach this line without an error, the decompression was successful.
        print("\n\nDecompressed data:", decompressed_data)

    except brotli.error:
        # If decompression failed, just pass and try the next chunk even though they will probably all fail.
        print("\n\nError decompressing data with chunks up to:", i + 1)

if decompressor.is_finished():
    print("\n\nAll data decompressed.")
else:
    print("\n\n!! Decompression not finished. but it should be !!")
